<html>
	<head>
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-35317955-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-35317955-1');
		</script>

		<meta charset="utf-8">

		<title>The E.T.C.</title>
		<meta name="description" content="The Electric Toy Company">
		<meta name="author" content="Jeff Wofford">
        <meta charset="utf-8" />
        <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1, maximum-scale=1" /> <!-- Control zooming, even when editing contenteditable elements. See https://weblog.west-wind.com/posts/2023/Apr/17/Preventing-iOS-Safari-Textbox-Zooming -->
        <link rel="apple-touch-icon" sizes="57x57" href="assets/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="assets/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="assets/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="assets/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="assets/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="assets/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="assets/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="assets/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="167x167" href="assets/apple-touch-icon-167x167.png">
        <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon-180x180.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="assets/apple-touch-icon-1024x1024.png">
        <link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" href="assets/apple-touch-startup-image-320x460.png">
        <link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" href="assets/apple-touch-startup-image-640x920.png">
        <link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="assets/apple-touch-startup-image-640x1096.png">
        <link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="assets/apple-touch-startup-image-750x1294.png">
        <link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)" href="assets/apple-touch-startup-image-1182x2208.png">
        <link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)" href="assets/apple-touch-startup-image-1242x2148.png">
        <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" href="assets/apple-touch-startup-image-748x1024.png">
        <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="assets/apple-touch-startup-image-1496x2048.png">
        <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" href="assets/apple-touch-startup-image-768x1004.png">
        <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="assets/apple-touch-startup-image-1536x2008.png">
        <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="228x228" href="assets/coast-228x228.png">
        <link rel="shortcut icon" href="assets/favicon.ico">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title">
        <meta name="application-name">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="msapplication-TileColor" content="#fff">
        <meta name="msapplication-TileImage" content="assets/mstile-144x144.png">
        <meta name="msapplication-config" content="assets/browserconfig.xml">
        <meta name="theme-color" content="#fff">

		<script>
			goFullscreen = null;

			function bailout() {
				window.location.replace( '/' );
			}

			function onGameStarting() {
				console.log( 'game done loading' );

				// Hide loading message.
				document.getElementById( 'loading-message' ).style.display = 'none';

				clearInterval( loadingInterval );
			}
		</script>

		<style>
			html, body {
				margin: 0;
				padding: 0;
				height: 100%;
				overflow: hidden;
			}

			#loading-message {
				position: fixed;
				left: 0;
				right: 0;
				margin-inline: auto;
				width: fit-content;
			}

			#canvas {
				display: block;
				width: 100vw;
				height: 100vh;
			}
		</style>

	</head>
	<body>
		<noscript>
			<header>Sorry, this site requires that Javascript be enabled in your browser.</header>
		</noscript>

		<main>
				<canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()"></canvas>

				<div id="loading-message"><div id='loading-message-contents'>loading</div></div>

				<script type="text/javascript">
					Module = {
						print: function(text) { console.log( text ); },
						printErr: function(text) { console.error( text ); },
						canvas: document.getElementById( "canvas" ),
					};
				</script>

				<script id='game-script' async></script>
			</div>
		</main>

		<script>
			// key blocker. prevent cursor keys from scrolling page while playing game.

			function onKeyDown_blocker(event) {
				event = event || window.event;
				var o = document.activeElement;
				if (!o || o == document.body || o.tagName == "canvas")
				{
					if ([32, 37, 38, 39, 40].indexOf(event.keyCode) > -1)
					{
						if (event.preventDefault) event.preventDefault();
					}
				}
			}

			document.addEventListener('keydown', onKeyDown_blocker, false);

			const gameShortName = 'fin';
			console.log( `Running fresh.ly-based game with short name "${gameShortName}".` );

			const gameTitle = '@73N: KEEP. HIM. ALIVE.';
			document.title = 'The E.T.C.: ' + gameTitle;

			const url = 'freshly.js';

			// Load the game.
			startGame = function() {

				console.log( 'starting game' )

				const canvas = document.getElementById( 'canvas' );
				document.getElementById( 'loading-message' ).style.display = 'block';

				goFullscreen = function() {
					console.log( 'Using canvas fullscreen' );
					const canvas = document.getElementById( 'canvas' );
					if( canvas.requestFullscreen ) { canvas.requestFullscreen(); }
					else if( canvas.mozRequestFullScreen ) { canvas.mozRequestFullScreen(); }
					else if( canvas.webkitRequestFullScreen ) { canvas.webkitRequestFullScreen(); }
					else if( canvas.msRequestFullscreen ) { canvas.msRequestFullscreen(); }
				}

				// Start loading cycle display
				//
				loadingTickCount = 0
				loadingInterval = setInterval( function() {
					loadingTickCount += 1;
					const count = loadingTickCount % 4;
					document.getElementById( 'loading-message' ).innerHTML = '&nbsp;'.repeat( count ) + 'loading' + '.'.repeat( count );
				}, 200 /* ms */ );

				document.getElementById( 'game-script' ).src = url;
			}

			startGame();

		</script>

	</body>
</html>